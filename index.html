<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thuisbatterij Calculator V15.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Roboto', sans-serif; background-color: #f0f4f8; color: #333; margin: 0; padding: 20px; display: flex; justify-content: center; align-items: center; min-height: 100vh; box-sizing: border-box; }
        .container { max-width: 700px; width: 100%; background-color: #ffffff; padding: 40px; border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); text-align: center; }
        .logo { max-width: 250px; width: 100%; height: auto; margin-bottom: 20px; }
        h1 { color: #1e3a5f; font-size: 2.5rem; margin-top: 0; }
        h2.question-title { font-size: 1.8rem; font-weight: 700; margin-bottom: 20px; color: #1e3a5f; }
        .step-container, #start-scherm { display: none; }
        .step-container.active, #start-scherm.active { display: block; }
        .answer-option { border: 2px solid #e0e6ed; border-radius: 12px; padding: 15px 20px; margin-bottom: 15px; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; text-align: left; }
        .answer-option:hover { border-color: #3498db; background-color: #f9fcff; }
        .answer-option.selected { border-color: #2ecc71; background-color: #eaf9ed; box-shadow: 0 4px 12px rgba(46, 204, 113, 0.2); }
        .answer-option .icon { font-size: 2rem; color: #1e3a5f; margin-right: 20px; display: flex; align-items: center; justify-content: center; width: 40px; flex-shrink: 0; }
        .input-text { width: 100%; padding: 12px; margin-bottom: 15px; border: 2px solid #e0e6ed; border-radius: 8px; box-sizing: border-box; font-size: 1rem; }
        .button-container { display: flex; justify-content: space-between; margin-top: 30px; }
        .btn { padding: 15px 30px; border: none; border-radius: 50px; cursor: pointer; font-size: 1rem; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; transition: all 0.3s ease; text-decoration: none; }
        .btn-primary { background-color: #3498db; color: white; }
        .btn-secondary { background-color: #e0e6ed; color: #555; }
        .progress-bar-container { background-color: #e0e6ed; border-radius: 50px; height: 10px; margin-bottom: 10px; }
        .progress-bar { height: 100%; background-color: #2ecc71; border-radius: 50px; width: 0%; transition: width 0.4s ease; }
        .progress-text { text-align: center; font-size: 0.9rem; margin-bottom: 20px; color: #555; }
        .results-grid { display: grid; grid-template-columns: 1fr; gap: 20px; text-align: left; margin-top: 20px; }
        .result-card { background-color: #f9fbfd; padding: 20px; border-radius: 12px; border: 1px solid #e0e6ed; }
        .result-card h3 { display: flex; justify-content: space-between; align-items: center; margin-top: 0; color: #1e3a5f; border-bottom: 2px solid #3498db; padding-bottom: 10px; }
        .main-recommendation { text-align: center; background-color: #eaf9ed; border-color: #2ecc71; }
        .chart-card { grid-column: 1 / -1; }
        .interactive-settings { grid-column: 1 / -1; }
        .setting-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-wrap: wrap; }
        .setting-row label { font-weight: 500; margin-right: 10px; flex-basis: 180px; text-align: left; }
        .setting-row input[type="range"] { flex-grow: 1; margin: 0 15px; }
        .setting-row .value-display { font-weight: 700; min-width: 60px; text-align: right; }
        .setting-row select { flex-grow: 1; padding: 5px; border-radius: 5px; border: 1px solid #ccc; }
        .switch { position: relative; display: inline-block; width: 50px; height: 28px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 28px; }
        .slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #2ecc71; }
        input:checked + .slider:before { transform: translateX(22px); }
        .version-display { font-size: 0.8em; color: #aaa; margin-top: 20px; text-align: center; }
        .chart-canvas-container { position: relative; height: 350px; width: 100%; }
        .chart-summary { display: flex; justify-content: space-around; text-align: center; margin-top: 15px; padding-top: 15px; border-top: 1px solid #e0e6ed; }
        .summary-item { font-size: 0.9em; }
        .summary-item strong { display: block; font-size: 1.2em; }
    </style>
</head>
<body>
    <div id="start-scherm" class="container active">
        <img src="exclupower-logo.jpg" alt="Exclupower Bedrijfslogo" class="logo">
        <h1>Welkom bij de Thuisbatterij Calculator</h1>
        <p>Ontdek welke thuisbatterij het beste bij uw situatie past.</p>
        <a href="#" class="btn btn-primary" id="startBtn">Start de berekening</a>
        <div class="version-display">Versie 15.0</div>
    </div>

    <div id="calculator-scherm" class="container" style="display: none;">
        <div id="step-1" class="step-container"> <h2 class="question-title">Wat is je geschatte jaarlijkse energieverbruik?</h2> <div class="answer-option" data-value="2000" onclick="selectAnswer(1, this)"><span class="icon">üè†</span>Tot 2.000 kWh</div> <div class="answer-option" data-value="3000" onclick="selectAnswer(1, this)"><span class="icon">üë®‚Äçüë©‚Äçüëß</span>2.000 - 4.000 kWh</div> <div class="answer-option" data-value="5000" onclick="selectAnswer(1, this)"><span class="icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</span>4.000 - 6.000 kWh</div> <div class="answer-option" data-value="7000" onclick="selectAnswer(1, this)"><span class="icon">üèòÔ∏è</span>6.000 - 8.000 kWh</div> <div class="answer-option" data-value="9000" onclick="selectAnswer(1, this)"><span class="icon">üè∞</span>8.000+ kWh</div> </div>
        <div id="step-2" class="step-container"> <h2 class="question-title">Heeft u al zonnepanelen?</h2> <div class="answer-option" data-value="ja" onclick="selectAnswer(2, this)"><span class="icon">‚òÄÔ∏è</span>Ja</div> <div class="answer-option" data-value="nee" onclick="selectAnswer(2, this)"><span class="icon">üö´</span>Nee</div> </div>
        <div id="step-3" class="step-container"> <h2 class="question-title">Heeft u interesse om zonnepanelen te laten installeren?</h2> <div class="answer-option" data-value="ja" onclick="selectAnswer(3, this)"><span class="icon">üëç</span>Ja, ik heb interesse</div> <div class="answer-option" data-value="nee" onclick="selectAnswer(3, this)"><span class="icon">üëé</span>Nee, op dit moment niet</div> </div>
        <div id="step-4" class="step-container"> <h2 class="question-title">Hoeveel zonnepanelen heeft u?</h2> <input type="number" id="panelenInput" class="input-text" placeholder="Voer het aantal zonnepanelen in" min="1"> <div class="answer-option" onclick="selectAnswer(4, this)" data-value="dummy"> <span class="icon">#Ô∏è‚É£</span>Klik op 'Volgende' als u het aantal heeft ingevuld. </div> </div>
        <div id="step-5" class="step-container"> <h2 class="question-title">Heeft u een elektrische auto?</h2> <div class="answer-option" data-value="ja" onclick="selectAnswer(5, this)"><span class="icon">üöó</span>Ja</div> <div class="answer-option" data-value="nee" onclick="selectAnswer(5, this)"><span class="icon">üö∂</span>Nee</div> </div>
        <div id="step-6" class="step-container"> <h2 class="question-title">Heeft u een warmtepomp?</h2> <div class="answer-option" data-value="ja" onclick="selectAnswer(6, this)"><span class="icon">üî•</span>Ja</div> <div class="answer-option" data-value="nee" onclick="selectAnswer(6, this)"><span class="icon">‚ùÑÔ∏è</span>Nee</div> </div>
        <div id="step-7" class="step-container"> <h2 class="question-title">Wil je een schaalbare batterij?</h2> <div class="answer-option" data-value="zeer-belangrijk" onclick="selectAnswer(7, this)"><span class="icon">üìà</span>Zeer belangrijk</div> <div class="answer-option" data-value="belangrijk" onclick="selectAnswer(7, this)"><span class="icon">üìä</span>Belangrijk</div> <div class="answer-option" data-value="niet-zo-belangrijk" onclick="selectAnswer(7, this)"><span class="icon">‚ûñ</span>Niet zo belangrijk</div> <div class="answer-option" data-value="helemaal-niet-belangrijk" onclick="selectAnswer(7, this)"><span class="icon">üö´</span>Helemaal niet belangrijk</div> </div>
        <div id="step-8" class="step-container"> <h2 class="question-title">Hoe belangrijk is smart home integratie?</h2> <div class="answer-option" data-value="zeer-belangrijk" onclick="selectAnswer(8, this)"><span class="icon">üí°</span>Zeer belangrijk</div> <div class="answer-option" data-value="belangrijk" onclick="selectAnswer(8, this)"><span class="icon">üì±</span>Belangrijk</div> <div class="answer-option" data-value="niet-zo-belangrijk" onclick="selectAnswer(8, this)"><span class="icon">üè†</span>Niet zo belangrijk</div> <div class="answer-option" data-value="helemaal-niet-belangrijk" onclick="selectAnswer(8, this)"><span class="icon">‚ùå</span>Helemaal niet belangrijk</div> </div>
        <div id="step-9" class="step-container"> <h2 class="question-title">Interesse in dynamische energieprijzen?</h2> <div class="answer-option" data-value="zeer-geinteresseerd" onclick="selectAnswer(9, this)"><span class="icon">üí∞</span>Ja, zeer ge√Ønteresseerd</div> <div class="answer-option" data-value="enigszins-geinteresseerd" onclick="selectAnswer(9, this)"><span class="icon">üìà</span>Ja, enigszins</div> <div class="answer-option" data-value="niet-geinteresseerd" onclick="selectAnswer(9, this)"><span class="icon">üí∏</span>Nee, niet ge√Ønteresseerd</div> </div>
        
        <div id="resultaat-stap" class="step-container">
            <h2 class="question-title">Uw Persoonlijke Advies Dashboard</h2>
            <div class="results-grid">
                <div class="result-card main-recommendation"> <h2>Uw Aanbevolen Batterijcapaciteit</h2> <p><strong id="capaciteitResultaat" style="font-size: 1.5em;"></strong></p> </div>
                <div class="result-card interactive-settings">
                    <h3>Verfijn uw advies</h3>
                    <div class="setting-row"> <label for="verbruikSlider">Jaarlijks verbruik</label> <input type="range" id="verbruikSlider" min="1000" max="15000" step="100"> <span class="value-display" id="verbruikValue"></span> </div>
                    <div class="setting-row"> <label for="panelenSlider">Aantal zonnepanelen</label> <input type="range" id="panelenSlider" min="0" max="40" step="1"> <span class="value-display" id="panelenValue"></span> </div>
                </div>

                <div class="chart-card" id="scenario1Div"> <h3>Scenario 1: Situatie Zonder Zonnepanelen</h3> <div class="chart-canvas-container"><canvas id="scenario1ChartCanvas"></canvas></div> <div class="chart-summary" id="summary1"></div> </div>
                <div class="chart-card" id="scenario2Div"> <h3>Scenario 2: Met Zonnepanelen</h3> <div class="chart-canvas-container"><canvas id="scenario2ChartCanvas"></canvas></div> <div class="chart-summary" id="summary2"></div> </div>
                <div class="chart-card" id="scenario3Div"> <h3>Scenario 3: Met Zonnepanelen & Thuisbatterij</h3> <div class="chart-canvas-container"><canvas id="scenario3ChartCanvas"></canvas></div> <div class="chart-summary" id="summary3"></div> </div>
            </div>
        </div>
        
        <div class="button-container"> <button class="btn btn-secondary" id="terugBtn" onclick="prevStep()">‚Üê Terug</button> <button class="btn btn-primary" id="volgendeBtn" onclick="nextStep()">Volgende ‚Üí</button> </div>
        <div class="version-display">Versie 15.0</div>
    </div>

    <script>
        let currentStep = 1; const totalSteps = 9; const formAnswers = {};
        const products = [ { naam: "Instap Batterij 2.5 kWh", capaciteit: 2.5 }, { naam: "Basis Batterij 5 kWh", capaciteit: 5 }, { naam: "Standaard Batterij 7.5 kWh", capaciteit: 7.5 }, { naam: "Standaard Batterij 10 kWh", capaciteit: 10 }, { naam: "Premium Batterij 12.5 kWh", capaciteit: 12.5 }, { naam: "Premium Batterij 15 kWh", capaciteit: 15 }, { naam: "Grootverbruiker Batterij 20 kWh", capaciteit: 20 } ];
        let scenario1Chart, scenario2Chart, scenario3Chart;
        
        document.addEventListener('DOMContentLoaded', () => { document.getElementById('startBtn').addEventListener('click', (e) => { e.preventDefault(); document.getElementById('start-scherm').style.display = 'none'; document.getElementById('calculator-scherm').style.display = 'block'; showStep(1); }); });
        function showStep(step) { document.querySelectorAll('.step-container').forEach(el => el.classList.remove('active')); const el = document.getElementById(`step-${step}`) || document.getElementById('resultaat-stap'); if (el) el.classList.add('active'); updateButtons(); updateProgressBar(); }
        function updateButtons() { const t = document.getElementById('terugBtn'), v = document.getElementById('volgendeBtn'); t.style.display = (currentStep > 1 && currentStep <= totalSteps + 1) ? 'block' : 'none'; v.style.display = (currentStep <= totalSteps) ? 'block' : 'none'; let l = false; let ts = currentStep; while (ts < totalSteps) { ts++; if (!isStepSkipped(ts)) { l = false; break; } l = true; } v.textContent = (currentStep >= totalSteps || l) ? 'Bereken advies' : 'Volgende ‚Üí'; }
        function updateProgressBar() { const p = ((currentStep - 1) / totalSteps) * 100; document.getElementById('progressBar').style.width = `${p}%`; document.getElementById('progressText').textContent = `${Math.round(p)}% Voltooid`; }
        function isStepSkipped(step) { if (step === 3 && formAnswers['step-2'] === 'ja') return true; if (step === 4 && formAnswers['step-2'] === 'nee') return true; return false; }
        function nextStep() { const cs = document.getElementById(`step-${currentStep}`); const so = cs.querySelector('.selected'); if (currentStep === 4) { const pi = document.getElementById('panelenInput'); if (!pi.value || parseInt(pi.value) <= 0) { alert("Vul een geldig aantal zonnepanelen in."); return; } formAnswers[`step-${currentStep}`] = parseInt(pi.value); cs.querySelector('.answer-option').classList.add('selected'); } else { if (!so) { alert("Selecteer een optie."); return; } formAnswers[`step-${currentStep}`] = so.dataset.value; } let l = false; let ts = currentStep; while (ts < totalSteps) { ts++; if (!isStepSkipped(ts)) { l = false; break; } l = true; } if (currentStep >= totalSteps || l) { berekenAdvies(); return; } do { currentStep++; } while (isStepSkipped(currentStep)); showStep(currentStep); }
        function prevStep() { delete formAnswers[`step-${currentStep}`]; do { currentStep--; } while (isStepSkipped(currentStep)); if (currentStep >= 1) showStep(currentStep); }
        function selectAnswer(step, element) { const c = document.getElementById(`step-${step}`); c.querySelectorAll('.answer-option').forEach(el => el.classList.remove('selected')); element.classList.add('selected'); }
        
        function berekenAdvies() { currentStep = totalSteps + 1; setupInteractiveControls(); showStep('resultaat-stap'); }
        function setupInteractiveControls() {
            const controls = ['verbruikSlider', 'panelenSlider'];
            controls.forEach(id => { document.getElementById(id).addEventListener('input', recalculateAndRedraw); });
            document.getElementById('verbruikSlider').value = formAnswers['step-1'];
            document.getElementById('panelenSlider').value = (formAnswers['step-2'] === 'ja') ? formAnswers['step-4'] : (formAnswers['step-3'] === 'ja' ? 12 : 0);
            recalculateAndRedraw();
        }
        
        function recalculateAndRedraw() {
            const state = { jaarlijksVerbruikKwh: parseInt(document.getElementById('verbruikSlider').value), aantalPanelen: parseInt(document.getElementById('panelenSlider').value), heeftZonnepanelenInitieel: formAnswers['step-2'] === 'ja' };
            const calculations = calculateAdvice(state);
            updateDashboardUI(state, calculations);
        }

        // --- VERNIEUWDE REKENLOGICA ---
        function calculateAdvice(state) {
            const totaalDagelijksVerbruik = state.jaarlijksVerbruikKwh / 365;
            let totaalWp = 0;
            if (state.aantalPanelen > 0) { const paneelType = state.heeftZonnepanelenInitieel ? 400 : 430; totaalWp = state.aantalPanelen * paneelType; }
            const dagelijkseOpbrengst = totaalWp * 0.9 / 365;
            
            const verbruikProfiel = [0.03,0.02,0.02,0.02,0.03,0.05,0.07,0.06,0.05,0.04,0.04,0.04,0.05,0.04,0.04,0.05,0.06,0.08,0.09,0.08,0.07,0.06,0.05,0.04];
            const zonneProfiel = [0,0,0,0,0,0.01,0.03,0.06,0.09,0.11,0.13,0.14,0.13,0.12,0.09,0.05,0.03,0.01,0,0,0,0,0,0];
            const geschaaldVerbruik = verbruikProfiel.map(p => p * totaalDagelijksVerbruik);
            const geschaaldeOpbrengst = zonneProfiel.map(p => p * dagelijkseOpbrengst);
            
            const totaalOverschot = geschaaldeOpbrengst.reduce((sum, opbrengst, i) => {
                const overschot = opbrengst - geschaaldVerbruik[i];
                return sum + (overschot > 0 ? overschot : 0);
            }, 0);
            
            const afgerondeCapaciteit = Math.ceil(totaalOverschot / 2.5) * 2.5;
            const batterijCapaciteit = Math.max(2.5, afgerondeCapaciteit);
            
            return { batterijCapaciteit, geschaaldVerbruik, geschaaldeOpbrengst };
        }

        function updateDashboardUI(state, calcs) {
            document.getElementById('verbruikValue').textContent = `${state.jaarlijksVerbruikKwh} kWh`;
            document.getElementById('panelenValue').textContent = `${state.aantalPanelen}`;
            document.getElementById('capaciteitResultaat').textContent = `${calcs.batterijCapaciteit.toFixed(1)} kWh`;
            
            renderScenario1Chart(calcs.geschaaldVerbruik);
            renderScenario2Chart(calcs.geschaaldVerbruik, calcs.geschaaldeOpbrengst);
            renderScenario3Chart(calcs.geschaaldVerbruik, calcs.geschaaldeOpbrengst, calcs.batterijCapaciteit);
        }
        
        // --- DRIE NIEUWE GRAFIEK FUNCTIES ---
        function renderScenario1Chart(verbruikData) {
            const ctx = document.getElementById('scenario1ChartCanvas').getContext('2d');
            const totalImport = verbruikData.reduce((a, b) => a + b, 0);
            document.getElementById('summary1').innerHTML = `
                <div class="summary-item"><strong>${totalImport.toFixed(1)} kWh</strong>Import van Net</div>
                <div class="summary-item"><strong>0 kWh</strong>Eigen Verbruik Zon</div>
                <div class="summary-item"><strong>0 kWh</strong>Export naar Net</div>`;
            
            if (scenario1Chart) scenario1Chart.destroy();
            scenario1Chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Array.from({length: 24}, (_, i) => `${i}:00`),
                    datasets: [{ label: 'Import van Net', data: verbruikData, backgroundColor: 'rgba(231, 76, 60, 0.7)' }]
                },
                options: { responsive: true, maintainAspectRatio: false, scales: { x: { stacked: true }, y: { stacked: true, title: {display: true, text: 'Energie (kWh)'} } }, plugins: { legend: { display: false } } }
            });
        }

        function renderScenario2Chart(verbruikData, opbrengstData) {
            const ctx = document.getElementById('scenario2ChartCanvas').getContext('2d');
            let totalImport = 0, totalExport = 0, totalDirectVerbruik = 0;
            const importData = [], exportData = [], directVerbruikData = [];
            
            for(let i=0; i<24; i++) {
                const direct = Math.min(verbruikData[i], opbrengstData[i]);
                const imp = verbruikData[i] > opbrengstData[i] ? verbruikData[i] - opbrengstData[i] : 0;
                const exp = opbrengstData[i] > verbruikData[i] ? opbrengstData[i] - verbruikData[i] : 0;
                importData.push(imp);
                exportData.push(exp);
                directVerbruikData.push(direct);
                totalImport += imp; totalExport += exp; totalDirectVerbruik += direct;
            }
            
            document.getElementById('summary2').innerHTML = `
                <div class="summary-item"><strong>${totalImport.toFixed(1)} kWh</strong>Import van Net</div>
                <div class="summary-item"><strong>${totalDirectVerbruik.toFixed(1)} kWh</strong>Eigen Verbruik Zon</div>
                <div class="summary-item"><strong>${totalExport.toFixed(1)} kWh</strong>Export naar Net</div>`;

            if (scenario2Chart) scenario2Chart.destroy();
            scenario2Chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Array.from({length: 24}, (_, i) => `${i}:00`),
                    datasets: [
                        { label: 'Eigen Verbruik Zon', data: directVerbruikData, backgroundColor: 'rgba(46, 204, 113, 0.7)' },
                        { label: 'Import van Net', data: importData, backgroundColor: 'rgba(231, 76, 60, 0.7)' },
                        { label: 'Export naar Net', data: exportData.map(v => -v), backgroundColor: 'rgba(155, 89, 182, 0.7)' }
                    ]
                },
                options: { responsive: true, maintainAspectRatio: false, scales: { x: { stacked: true }, y: { stacked: true, title: {display: true, text: 'Energie (kWh)'} } }, plugins: { legend: { display: false } } }
            });
        }

        function renderScenario3Chart(verbruikData, opbrengstData, batterijCapaciteit) {
            const ctx = document.getElementById('scenario3ChartCanvas').getContext('2d');
            let totalImport = 0, totalDirectVerbruik = 0, totalBattVerbruik = 0, batterijLading = 0;
            const importData = [], directVerbruikData = [], battVerbruikData = [];

            for(let i=0; i<24; i++) { // Laadcyclus
                const overschot = opbrengstData[i] - verbruikData[i];
                if (overschot > 0) {
                    const kanLaden = batterijCapaciteit - batterijLading;
                    const laadHoeveelheid = Math.min(overschot, kanLaden);
                    batterijLading += laadHoeveelheid;
                }
            }
            for(let i=0; i<24; i++) { // Ontlaadcyclus
                const direct = Math.min(verbruikData[i], opbrengstData[i]);
                let tekort = verbruikData[i] - opbrengstData[i];
                if (tekort > 0) {
                    const kanOntladen = batterijLading;
                    const ontlaadHoeveelheid = Math.min(tekort, kanOntladen);
                    batterijLading -= ontlaadHoeveelheid;
                    battVerbruikData.push(ontlaadHoeveelheid);
                    totalBattVerbruik += ontlaadHoeveelheid;
                    const imp = tekort - ontlaadHoeveelheid;
                    importData.push(imp);
                    totalImport += imp;
                } else {
                    importData.push(0);
                    battVerbruikData.push(0);
                }
                directVerbruikData.push(direct);
                totalDirectVerbruik += direct;
            }
            
            document.getElementById('summary3').innerHTML = `
                <div class="summary-item"><strong>${totalImport.toFixed(1)} kWh</strong>Import van Net</div>
                <div class="summary-item"><strong>${(totalDirectVerbruik + totalBattVerbruik).toFixed(1)} kWh</strong>Eigen Verbruik (Zon+Batt)</div>
                <div class="summary-item"><strong>0 kWh</strong>Export naar Net</div>`;

            if (scenario3Chart) scenario3Chart.destroy();
            scenario3Chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Array.from({length: 24}, (_, i) => `${i}:00`),
                    datasets: [
                        { label: 'Eigen Verbruik Zon', data: directVerbruikData, backgroundColor: 'rgba(46, 204, 113, 0.7)' },
                        { label: 'Verbruik uit Batterij', data: battVerbruikData, backgroundColor: 'rgba(52, 152, 219, 0.7)' },
                        { label: 'Import van Net', data: importData, backgroundColor: 'rgba(231, 76, 60, 0.7)' }
                    ]
                },
                options: { responsive: true, maintainAspectRatio: false, scales: { x: { stacked: true }, y: { stacked: true, title: {display: true, text: 'Energie (kWh)'} } }, plugins: { legend: { display: false } } }
            });
        }
    </script>
</body>
</html>
